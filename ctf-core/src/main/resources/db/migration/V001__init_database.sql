 CREATE TABLE public.organisation (
 	id int8 NOT NULL GENERATED BY DEFAULT AS IDENTITY,
 	image TEXT,
 	name varchar(255) NULL,
 	CONSTRAINT organisation_pkey PRIMARY KEY (id)
 );

CREATE TABLE public.app_user (
	id int8 NOT NULL GENERATED BY DEFAULT AS IDENTITY,
	enabled bool NOT NULL,
	"password" varchar(255) NULL,
	username varchar(255) NOT NULL,
	roles int4 NOT NULL DEFAULT 1,
	organisation_id int8 NOT NULL,
	CONSTRAINT app_user_pkey PRIMARY KEY (id),
	CONSTRAINT uk_3k4cplvh82srueuttfkwnylq0 UNIQUE (username),
	CONSTRAINT FK_user_org FOREIGN KEY (organisation_id) REFERENCES public.organisation(id)
);


-- Drop table

-- DROP TABLE public.flag;

CREATE TABLE public.flag (
	id int8 NOT NULL GENERATED BY DEFAULT AS IDENTITY,
	code varchar(255) NOT NULL,
	description varchar(255) NOT NULL,
	start_date timestamp NOT NULL,
	end_date timestamp NOT NULL,
	title varchar(255) NOT NULL,
	url varchar(255) NOT NULL,
	CONSTRAINT flag_pkey PRIMARY KEY (id)
);

-- Drop table

-- DROP TABLE public.invite_code;

CREATE TABLE public.invite_code (
	id int8 NOT NULL GENERATED BY DEFAULT AS IDENTITY,
	invite_code varchar(255) NULL,
	active bool NOT NULL,
	applicant_id int8 NULL,
	owner_id int8 NULL,
	CONSTRAINT invite_code_pkey PRIMARY KEY (id),
	CONSTRAINT fk870b3eedl5vva1hiulllnw6aq FOREIGN KEY (applicant_id) REFERENCES public.app_user(id),
	CONSTRAINT fkpljv57gujwme2a2jnunh8l0a9 FOREIGN KEY (owner_id) REFERENCES public.organisation(id)
);

-- Drop table

-- DROP TABLE public.submission;

CREATE TABLE public.submission (
    id int8 NOT NULL GENERATED BY DEFAULT AS IDENTITY,
	submission timestamp NULL,
	user_id int8 NULL,
	flag_id int8 NULL,
	CONSTRAINT submission_pkey PRIMARY KEY (id),
	CONSTRAINT fk6wnhh3yek5thbeux6j2clid28 FOREIGN KEY (flag_id) REFERENCES public.flag(id),
	CONSTRAINT fkql0hsbof1jda7dwhs5vh59s5w FOREIGN KEY (user_id) REFERENCES public.app_user(id)
);



